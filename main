{
  "name": "my-kids-manager",
  "version": "1.0.0",
  "main": "expo-router/entry",
  "scripts": {
    "start": "expo start",
    "android": "expo start --android",
    "ios": "expo start --ios",
    "web": "expo start --web"
  },
  "dependencies": {
    "@react-native-async-storage/async-storage": "1.23.1",
    "date-fns": "^3.6.0",
    "expo": "~51.0.0",
    "expo-constants": "~16.0.1",
    "expo-device": "~6.0.2",
    "expo-linking": "~6.3.1",
    "expo-notifications": "~0.28.1",
    "expo-router": "~3.5.14",
    "expo-status-bar": "~1.12.1",
    "nativewind": "^2.0.11",
    "react": "18.2.0",
    "react-native": "0.74.1",
    "react-native-reanimated": "~3.10.1",
    "react-native-safe-area-context": "4.10.1",
    "react-native-screens": "3.31.1",
    "react-native-svg": "15.2.0",
    "zustand": "^4.5.2"
  },
  "devDependencies": {
    "@babel/core": "^7.20.0",
    "@types/react": "~18.2.45",
    "tailwindcss": "^3.3.2",
    "typescript": "~5.3.3"
  },
  "private": true
}
{
  "cli": {
    "version": ">= 12.0.0"
  },
  "build": {
    "development": {
      "developmentClient": true,
      "distribution": "internal"
    },
    "preview": {
      "distribution": "internal"
    },
    "production": {
      "autoIncrement": true
    }
  },
  "submit": {
    "production": {}
  }
}
{
  "expo": {
    "name": "KidsManager",
    "slug": "my-kids-manager",
    "version": "1.0.0",
    "orientation": "portrait",
    "icon": "./assets/icon.png",
    "userInterfaceStyle": "light",
    "splash": {
      "image": "./assets/splash.png",
      "resizeMode": "contain",
      "backgroundColor": "#ffffff"
    },
    "ios": {
      "supportsTablet": true,
      "bundleIdentifier": "com.yourname.kidsmanager"
    },
    "android": {
      "adaptiveIcon": {
        "foregroundImage": "./assets/adaptive-icon.png",
        "backgroundColor": "#ffffff"
      },
      "package": "com.yourname.kidsmanager"
    },
    "plugins": [
      "expo-router",
      "expo-notifications"
    ],
    "experiments": {
      "typedRoutes": true
    }
  }
}
module.exports = {
  content: ["./app/**/*.{js,jsx,ts,tsx}", "./components/**/*.{js,jsx,ts,tsx}"],
  theme: {
    extend: {},
  },
  plugins: [],
}
export type Child = { id: string; name: string; color: string; };
export type Activity = {
  id: string; childId: string; name: string; cost: number;
  paymentDate: string; type: 'lesson' | 'subscription';
  remindDaysBefore?: number;
};
export type Event = {
  id: string; activityId: string; date: string; time: string;
  note?: string; isSpecialTask: boolean;
};
import { create } from 'zustand';
import { persist, createJSONStorage } from 'zustand/middleware';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { Child, Activity, Event } from './types';

interface AppState {
  children: Child[]; activities: Activity[]; events: Event[];
  addActivity: (a: Activity) => void;
  deleteActivity: (id: string) => void;
}

export const useAppStore = create<AppState>()(
  persist(
    (set) => ({
      children: [
        { id: '1', name: '兄', color: '#3b82f6' },
        { id: '2', name: '妹', color: '#ec4899' }
      ],
      activities: [], events: [],
      addActivity: (a) => set((s) => ({ activities: [...s.activities, a] })),
      deleteActivity: (id) => set((s) => ({ activities: s.activities.filter(x => x.id !== id) })),
    }),
    { name: 'kids-storage', storage: createJSONStorage(() => AsyncStorage) }
  )
);
import { Stack } from 'expo-router';
export default function RootLayout() {
  return (
    <Stack>
      <Stack.Screen name="(tabs)" options={{ headerShown: false }} />
      <Stack.Screen name="activity/[id]" options={{ title: '詳細' }} />
      <Stack.Screen name="activity/edit" options={{ title: '登録', presentation: 'modal' }} />
    </Stack>
  );
}
import { View, Text, ScrollView } from 'react-native';
import { useAppStore } from '../../lib/store';

export default function Home() {
  const { activities } = useAppStore();
  return (
    <ScrollView className="flex-1 bg-gray-50 p-4">
      <Text className="text-2xl font-bold mb-4">マイダッシュボード</Text>
      {activities.length === 0 ? (
        <Text className="text-gray-400">習い事を登録しましょう</Text>
      ) : (
        activities.map(a => (
          <View key={a.id} className="bg-white p-4 rounded-lg mb-2 shadow-sm">
            <Text className="font-bold">{a.name}</Text>
            <Text>¥{a.cost.toLocaleString()}</Text>
          </View>
        ))
      )}
    </ScrollView>
  );
}
import React from 'react';
import { View, Text, ScrollView } from 'react-native';
import { useAppStore } from '../../lib/store';
import { format, startOfWeek, addDays, eachDayOfInterval } from 'date-fns';
import { ja } from 'date-fns/locale';

export default function CalendarScreen() {
  const { activities, children } = useAppStore();
  const today = new Date();
  const start = startOfWeek(today, { weekStartsOn: 0 });
  const weekDays = eachDayOfInterval({ start, end: addDays(start, 6) });

  return (
    <View className="flex-1 bg-gray-100">
      <View className="p-4 bg-white border-b border-gray-200">
        <Text className="text-2xl font-bold text-gray-800">カレンダー</Text>
      </View>
      <View className="flex-row justify-around bg-white py-2 border-b border-gray-200">
        {weekDays.map(day => (
          <View key={day.toString()} className="items-center">
            <Text className="text-xs text-gray-500">{format(day, 'E', { locale: ja })}</Text>
            <Text className="text-lg font-semibold">{format(day, 'd')}</Text>
          </View>
        ))}
      </View>
      <ScrollView className="flex-1 p-2">
        <Text className="text-center text-gray-400 mt-10">今週の予定がここに表示されます</Text>
      </ScrollView>
    </View>
  );
}
import React from 'react';
import { View, Text, ScrollView, TouchableOpacity } from 'react-native';
import { Link, useRouter } from 'expo-router';
import { useAppStore } from '../../lib/store';
import { FontAwesome } from '@expo/vector-icons';

export default function ActivitiesScreen() {
  const { children, activities } = useAppStore();
  const router = useRouter();

  return (
    <View className="flex-1 bg-gray-100">
      <View className="p-4 bg-white border-b border-gray-200 flex-row justify-between items-center">
        <Text className="text-2xl font-bold text-gray-800">習い事・サブスク</Text>
        <TouchableOpacity onPress={() => router.push('/activity/edit')} className="bg-blue-500 w-10 h-10 rounded-full items-center justify-center">
          <FontAwesome name="plus" size={20} color="white" />
        </TouchableOpacity>
      </View>
      <ScrollView className="flex-1 p-4">
        {children.map(child => (
          <View key={child.id} className="mb-6">
            <Text className="text-xl font-bold mb-3" style={{ color: child.color }}>{child.name}</Text>
            {activities.filter(a => a.childId === child.id).map(activity => (
              <Link key={activity.id} href={`/activity/${activity.id}`} asChild>
                <TouchableOpacity className="bg-white p-4 rounded-lg shadow-sm mb-2 flex-row justify-between items-center">
                  <View>
                    <Text className="text-lg font-bold">{activity.name}</Text>
                    <Text className="text-gray-500">¥{activity.activity.cost.toLocaleString()} / 毎月{activity.paymentDate}日</Text>
                  </View>
                  <FontAwesome name="chevron-right" size={14} color="#ccc" />
                </TouchableOpacity>
              </Link>
            ))}
          </View>
        ))}
      </ScrollView>
    </View>
  );
}
import React from 'react';
import { View, Text, TouchableOpacity, Alert, Share } from 'react-native';
import { useLocalSearchParams, useRouter, Stack } from 'expo-router';
import { useAppStore } from '../../lib/store';

export default function ActivityDetail() {
  const { id } = useLocalSearchParams();
  const router = useRouter();
  const { activities, deleteActivity } = useAppStore();
  const activity = activities.find(a => a.id === id);

  if (!activity) return <Text>Not Found</Text>;

  const handleDelete = () => {
    Alert.alert('削除', '本当に削除しますか？', [
      { text: 'キャンセル', style: 'cancel' },
      { text: '削除', style: 'destructive', onPress: () => { deleteActivity(activity.id); router.back(); } }
    ]);
  };

  return (
    <View className="flex-1 bg-white p-6">
      <Stack.Screen options={{ title: activity.name }} />
      <Text className="text-3xl font-bold mb-4">{activity.name}</Text>
      <View className="bg-gray-50 p-4 rounded-xl mb-6">
        <Text className="text-gray-600">月謝: ¥{activity.cost.toLocaleString()}</Text>
        <Text className="text-gray-600">引き落とし日: 毎月{activity.paymentDate}日</Text>
      </View>
      <TouchableOpacity onPress={handleDelete} className="bg-red-50 p-4 rounded-lg items-center">
        <Text className="text-red-500 font-bold">この習い事を削除する</Text>
      </TouchableOpacity>
    </View>
  );
}
import React, { useState } from 'react';
import { View, Text, TextInput, TouchableOpacity, ScrollView } from 'react-native';
import { useRouter } from 'expo-router';
import { useAppStore } from '../../lib/store';

export default function EditActivity() {
  const router = useRouter();
  const { children, addActivity } = useAppStore();
  const [name, setName] = useState('');
  const [cost, setCost] = useState('');
  const [paymentDate, setPaymentDate] = useState('');
  const [childId, setChildId] = useState(children[0].id);

  const handleSave = () => {
    addActivity({
      id: Math.random().toString(36).substr(2, 9),
      childId, name, cost: parseInt(cost), paymentDate, type: 'lesson'
    });
    router.back();
  };

  return (
    <ScrollView className="flex-1 bg-white p-4">
      <Text className="font-bold mb-2">習い事名</Text>
      <TextInput className="border border-gray-200 p-3 rounded-lg mb-4" value={name} onChangeText={setName} />
      <Text className="font-bold mb-2">月謝</Text>
      <TextInput className="border border-gray-200 p-3 rounded-lg mb-4" value={cost} onChangeText={setCost} keyboardType="numeric" />
      <Text className="font-bold mb-2">引き落とし日</Text>
      <TextInput className="border border-gray-200 p-3 rounded-lg mb-4" value={paymentDate} onChangeText={setPaymentDate} keyboardType="numeric" />
      <TouchableOpacity onPress={handleSave} className="bg-blue-500 p-4 rounded-lg items-center">
        <Text className="text-white font-bold">保存する</Text>
      </TouchableOpacity>
    </ScrollView>
  );
}
import * as Notifications from 'expo-notifications';

export async function registerForPushNotificationsAsync() {
  const { status } = await Notifications.requestPermissionsAsync();
  if (status !== 'granted') {
    alert('通知許可が必要です');
    return;
  }
}

export async function scheduleNotification(title: string, body: string, day: number) {
  await Notifications.scheduleNotificationAsync({
    content: { title, body },
    trigger: { day, hour: 9, minute: 0, repeats: true },
  });
}
module.exports = function(api) {
  api.cache(true);
  return {
    presets: ['babel-preset-expo'],
    plugins: ["nativewind/babel"],
  };
};
